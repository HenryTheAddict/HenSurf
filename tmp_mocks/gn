#!/bin/bash
echo "Mock gn: Called with $*" >> /tmp/gn_calls.log
if [[ "$1" == "gen" ]]; then
  out_dir="$2"
  args="${*:3}"
  echo "Mock gn: Simulating gen for $out_dir with args $args" >> /tmp/gn_calls.log
  mkdir -p "$out_dir"
  echo "Mock gn: creating/updating $out_dir/args.gn with $args" >> /tmp/gn_calls.log
  # Append args to a file for easier verification if multiple calls or complex args
  echo "$args" >> "$out_dir/args.gn.log"
  # Simulate the actual args.gn file
  # This is a simplified representation; real args.gn is more structured
  echo "# Automatically generated by mock gn" > "$out_dir/args.gn"
  echo "$args" >> "$out_dir/args.gn"
elif [[ "$1" == "args" && "$3" == "--list" ]]; then
    out_dir="$2"
    echo "Mock gn: Simulating list args for $out_dir" >> /tmp/gn_calls.log
    if [ -f "$out_dir/args.gn" ]; then
        cat "$out_dir/args.gn"
    else
        echo "is_debug = false"
        echo "target_cpu = \"arm64\"" # Default mock value
    fi
else
  echo "Mock gn: Unhandled command or args: $*" >> /tmp/gn_calls.log
fi
